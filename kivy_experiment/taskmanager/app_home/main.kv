#: import utils kivy.utils
#: import icon kivy.garden.iconfonts.icon
#: import mtx kivy.metrics
#: import WipeTransition kivy.uix.screenmanager.WipeTransition
#: import DatePicker datepicker.datepicker.DatePicker

<MainWindow>:
    orientation: 'vertical'
    canvas.before:
        Color:
            rgba: [1,1,1,1]
        Rectangle:
            pos: self.pos
            size: self.size
    
    ScreenManager:
        id: scrn_mngr
        Screen:
            name: 'scrn_signin'
            BoxLayout:
                orientation: 'vertical' 
                # margin: 10
                spacing: 15 
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex("#FFC444")
                    Rectangle:
                        pos: self.pos
                        size: self.size
                Widget:
                    size_hint_y: .25
                Label:
                    text: "Task List"
                    font_size: mtx.sp('32')
             
                    bold: True
                    color: utils.get_color_from_hex("#36290D")
                    size_hint_y: .1
                Image:
                    source: 'app/assets/undraw_online_organizer.png'
                    size: self.texture_size
                    size_hint_y: .2
                BoxLayout:
                    size_hint_y: .45
                    orientation: 'vertical'
                    padding: [mtx.dp(20), 0]
                    FLatInput:
                        id: si_username
                        hint_text: 'username'
                        size_hint_y: .1
                    Widget:
                        size_hint_y: .01
                    FLatInput:
                        id: si_password
                        hint_text: 'password'
                        size_hint_y: .1
                        password: True
                    Widget:
                        size_hint_y: .05
                    FLatButton:
                        text: 'Login'
                        bold: True
                        size_hint_y: .1
                        on_release: 
                            root.auth_user(si_username, si_password)
                            scrn_mngr.transition.direction = "left"
                        canvas.before:
                            Color:
                                rgb: utils.get_color_from_hex("#282C34")
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [8]

                    FLatButton:
                        text: 'New here? Sign up'
                        size_hint_y: .1
                        on_release: 
                            scrn_mngr.current = "scrn_signup"
                            scrn_mngr.transition.direction = "left"
                    Widget:
                        size_hint_y: .3
                             
        Screen:
            name: 'scrn_signup'
            BoxLayout:
                orientation: 'vertical'
                spacing: 15 
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex("#282C34") 
                    Rectangle:
                        pos: self.pos
                        size: self.size
                Widget:
                    size_hint_y: .25
                Label:
                    text: "Welcome Aboard!"
                    font_size: mtx.sp('32')
                    bold: True
                    color: utils.get_color_from_hex("#ffffff")
                    size_hint_y: .15

                Image:
                    source: 'app/assets/undraw_with_love.png'
                    size: self.texture_size
                    size_hint_y: .25

                BoxLayout:
                    size_hint_y: .45
                    orientation: 'vertical'
                    padding: [mtx.dp(20), 0]
                    FLatInput:
                        id: su_username
                        hint_text: 'username'
                        size_hint_y: .1
                    Widget:
                        size_hint_y: .01
                    FLatInput:
                        id: su_password
                        hint_text: 'password'
                        size_hint_y: .1
                        password: True
                    Widget:
                        size_hint_y: .05
                    FLatButton:
                        text: 'Sign up'
                        bold: True
                        color: utils.get_color_from_hex("#282C34")
                        size_hint_y: .1
                        canvas.before:
                            Color:
                                rgb: utils.get_color_from_hex("#FFC444")
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [8]

                    FLatButton:
                        text: 'Already have an account? Login'
                        size_hint_y: .1
                        on_release: 
                            scrn_mngr.current = "scrn_signin"
                            scrn_mngr.transition.direction = "right"
                    Widget:
                        size_hint_y: .3
        Screen:
            name: 'scrn_main'
            BoxLayout:
                orientation: 'vertical'
                canvas.before: 
                    Color:
                        rgba: utils.get_color_from_hex("#282C34")
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    padding: 20
                    size_hint_y: .1
                    FLatButton:
                        text: icon('zmdi-menu')
                        markup: True
                        text_size: self.size
                        valign: 'middle'
                        font_size: mtx.sp(24)
                        on_release: 
                            scrn_mngr.current = "scrn_signin"
                            scrn_mngr.transition.direction = "right"

                BoxLayout:
                    orientation: 'vertical'
                    canvas.before:
                        Color:
                            rgba: utils.get_color_from_hex("#282C34")
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius: [8,8,0,0]
                    
                    BoxLayout:
                        size_hint_y: .3
                        orientation: 'vertical'
                        BoxLayout:
                            size_hint_y: .1
                            padding: [10,0]
                            Label:
                                text: icon('zmdi-arrow-forward')
                                font_size: mtx.sp(24)
                                markup: True
                                size_hint_x: .1
                            Widget:
                                size_hint_x: .7
                            Label:
                                text:'TODAY'
                                bold: True
                                size_hint_x: .2
                                text_size: self.size
                                halign: 'right'
                        BoxLayout:
                            size_hint_y: .9
                            id: scroll_parent
                            ScrollView:
                                id: sv_today
                                do_scroll: [True, False]
                                scroll_type: ['content']
                                size_hint_y: None
                                height: self.parent.height
                                effect_cls: "ScrollEffect"
                                # bar_width: 
                                GridLayout:
                                    id: today_wrapper
                                    rows: 1
                                    padding: (mtx.dp(10), mtx.dp(10), mtx.dp(10), mtx.dp(20))
                                    spacing: mtx.dp(10)
                                    size: self.minimum_size
                                    size_hint: (None, None)
                                    Task:
                                        name: 'Task 001asdadasddsda'
                                        time: '10:24 am'
                                        size_hint: (None, None)
                                        size: [scroll_parent.width/2.4, scroll_parent.height-(.1*scroll_parent.height)]
                                    Task:
                                        name: 'Add New'
                                        time: '03:24 pm'
                                        on_release: root.add_new()
                                        size_hint: (None, None)
                                        size: [scroll_parent.width/2.4, scroll_parent.height-(.1*scroll_parent.height)]
                                    Button:
                                        text: '3'
                                        size_hint: (None, None)
                                        size: [scroll_parent.width/2, scroll_parent.height-20]
                                    Button:
                                        text: '4'
                                        size_hint: (None, None)
                                        size: [scroll_parent.width/2, scroll_parent.height-20]
                                    
                    BoxLayout:
                        size_hint_y: .7
                        canvas.before:
                            Color:
                                rgba: utils.get_color_from_hex("#F8F9FD")
                            RoundedRectangle:
                                pos: self.pos
                                size: self.size
                                radius: [8,8,0,0]
        Screen:
            name: 'scrn_today'
            BoxLayout:
                orientation: 'vertical'
                Button:
                    text:'Go To Signin'
                    on_release: scrn_mngr.current = 'scrn_signin'
<NewTask>:
    size_hint: [.8, .5]
    BoxLayout:
        orientation:'vertical'
        padding: '10dp'
        spacing: '12dp'
        # canvas.before:
        #     Color:
        #         rgba: rgba('#ffffff')
        #     RoundedRectangle:
        #         pos: self.pos
        #         size: self.size
        #         radius: [8]
        BoxLayout:
            size_hint_y: .15
            # padding: '4dp'
            FlatInputWhite:
                id: task_name
                hint_text: 'task name'
                hint_text_color: rgba('#282C34')
        Widget:
            size_hint_y: .16
        BoxLayout:
            id: datetime
            size_hint_y: .15
            # padding: '4dp'
            DatePicker:
                id: task_date
                size_hint_x: .7
                background_active: ''
                background_normal: ''
                background_color: [1,1,1,0]
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex("#ffffff")
                    Rectangle:
                        pos: self.pos
                        size: [self.size[0], 1]
            FLatButton:
                id: task_time
                text: '00:00'
                size_hint_x: .3
                on_release: root.get_time()



        Widget:
            size_hint_y: .1
        FLatButton:
            text: 'Submit'
            bold: True
            size_hint_y: .1
            color: utils.get_color_from_hex("#282C34")
            canvas.before:
                Color:
                    rgba: rgba('#FFC444')
                RoundedRectangle:
                    pos: self.pos
                    size: self.size


<Task>:
    orientation: "vertical"
    padding: mtx.dp(15)
    canvas.before: 
        Color:
            rgba: rgba('#FFC444')
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [8]

    Label:
        id: task_name
        text: root.name
        bold: True
        font_size: mtx.sp(16)
        size_hint_y: .15
        color: rgba('#282C34')
        text_size: self.size
        shorten: True
        shorten_from: 'right'
        halign: "right"
    BoxLayout:
        size_hint_y: .15
        Label:
            text: icon('zmdi-time-countdown')
            markup: True
            size_hint_x: .6
            text_size: self.size
            halign: 'right'
            color: rgba('#282C34')
        Label:
            id: task_time
            text: root.time
            size_hint_x: .4
            text_size: self.size
            halign: "right"
            color: rgba('#282C34')
    
    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'bottom'
        size_hint_y: .70
        FLatButton:
            text: icon('zmdi-delete')
            markup: True
            font_size: '24sp'
            size_hint_x: .2
            color: rgba('#282C34')

<FLatButton@Button>:
    background_normal: ''
    background_color: [0, 0, 0, 0]

<FLatInput@TextInput>:
    background_active: ''
    background_normal: ''
    background_color: [1,1,1,0]
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex("#ffffff")
        Rectangle:
            pos: self.pos
            size: [self.size[0], 1]

<FlatInputWhite@TextInput>:
    background_active: ''
    background_normal: ''
    background_color: [1,1,1,0]
    canvas.before:
        Color:
            rgba: rgba("#ffffff")
        Rectangle:
            pos: self.pos
            size: [self.size[0], 1]